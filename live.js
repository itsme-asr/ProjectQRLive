// Bhajan data
const bhajans = {
    "bhajan1": {
    "title": "Samsara Davanala Lidha Loka",
    "english": "(1) saṁsāra-dāvānala-līḍha-loka\ntrāṇāya kāruṇya-ghanāghanatvam\nprāptasya kalyāṇa-guṇārṇavasya\nvande guroḥ śrī-caraṇāravindam\n\n(2) mahāprabhoḥ kīrtana-nṛtya-gīta\nvāditra-mādyan-manaso rasena\nromāñca-kampāśru-taraṅga-bhājo\nvande guroḥ śrī-caraṇāravindam\n\n(3) śrī-vigrahārādhana-nitya-nānā\nśṛṅgāra-tan-mandira-mārjanādau\nyuktasya bhaktāṁś ca niyuñjato ‘pi\nvande guroḥ śrī-caraṇāravindam\n\n(4) catur-vidha-śrī-bhagavat-prasāda\nsvādvanna-tṛptān hari-bhakta-saṅghān\nkṛtvaiva tṛptiṁ bhajataḥ sadaiva\nvande guroḥ śrī-caraṇāravindam\n\n(5) śrī-rādhikā-mādhavayor apāra\nmādhurya-līlā guṇa-rūpa-nāmnām\nprati-kṣaṇāsvādana-lolupasya\nvande guroḥ śrī-caraṇāravindam\n\n(6) nikuñja-yūno rati-keli-siddhyai\nyā yālibhir yuktir apekṣaṇīyā\ntatrāti-dākṣyād ati-vallabhasya\nvande guroḥ śrī-caraṇāravindam\n\n(7) sākṣād-dharitvena samasta-śāstrair\nuktas tathā bhāvyata eva sadbhiḥ\nkintu prabhor yaḥ priya eva tasya\nvande guroḥ śrī-caraṇāravindam\n\n(8) yasya prasādād bhagavat-prasādo\nyasyāprasādān na gatiḥ kuto ‘pi\ndhyāyan stuvaṁs tasya yaśas tri-sandhyaṁ\nvande guroḥ śrī-caraṇāravindam",
    "hindi": "(1) संसार-दावानल-लीढ-लोक\nत्राणाय कारुण्य-घनाघनत्वम्\nप्राप्तस्य कल्याण-गुणार्णवस्य\nवन्दे गुरोः श्री-चरणारविन्दम्\n\n(2) महाप्रभोः कीर्तन-नृत्य-गीत\nवादित्र-माद्यन्-मनसो रसेन\nरोमाञ्च-कम्पाश्रु-तरंग-भाजो\nवन्दे गुरोः श्री-चरणारविन्दम्\n\n(3) श्री-विग्रहाराधन-नित्य-नाना\nशृङ्गार-तन्-मन्दिर-मार्जनादौ\nयुक्तस्य भक्तांश्च नियुं‍जतोऽपि\nवन्दे गुरोः श्री-चरणारविन्दम्\n\n(4) चतुर्विध-श्री-भगवत-प्रसाद\nस्वाद्वन्न-तृप्तान हरि-भक्त-सङ्घान्\nकृत्वैव तृप्तिं भजतः सदाैव\nवन्दे गुरोः श्री-चरणारविन्दम्\n\n(5) श्री-राधिकामाधवयोः अपार\nमाधुर्य-लीला गुण-रूप-नाम्नां\nप्रति-क्षणास्वादन-लोलुपस्य\nवन्दे गुरोः श्री-चरणारविन्दम्\n\n(6) निकुञ्ज-यूनो रति-केलि-सिद्ध्यै\nया यालिभिः युक्तिर अपेक्षणीया\nतत्राति-दाक्ष्याद अति-वल्लभस्य\nवन्दे गुरोः श्री-चरणारविन्दम्\n\n(7) साक्षाद्-धरतिवेन समस्त-शास्त्रैः\nुक्तस् तथा भाव्यत एव सद्धिः\nकिन्तु प्रभोर यः प्रिय एव तस्य\nवन्दे गुरोः श्री-चरणारविन्दम्\n\n(8) यस्य प्रसादाद भगवत्-प्रसादो\nयस्या-प्रसादान् न गति कुतोऽपि\nध्यायन् स्तुवन् तस्य यशस् त्रिसंध्यं\nवन्दे गुरोः श्री-चरणारविन्दम्"
  },
    "bhajan2": {
    "title": "Śrī Guru Vandana",
    "english": "(1) śrī-guru-caraṇa-padma, kevala-bhakati-sadma,\nbando mui sāvadhāna mate\njāhāra prasāde bhāi, e bhava toriyā jāi,\nkṛṣṇa-prāpti hoy jāhā ha’te\n\n(2) guru-mukha-padma-vākya, cittete koriyā aikya,\nār nā koriho mane āśā\nśrī-guru-caraṇe rati, ei se uttama-gati,\nje prasāde pūre sarva āśā\n\n(3) cakhu-dān dilo jei, janme janme prabhu sei,\ndivya jñān hṛde prokāśito\nprema-bhakti jāhā hoite, avidyā vināśa jāte,\nvede gāy jāhāra carito\n\n(4) śrī-guru karuṇā-sindhu, adhama janāra bandhu,\nlokanāth lokera jīvana\nhā hā prabhu koro doyā, deho more pada-chāyā,\nebe jaśa ghuṣuk tribhuvana",
    "hindi": "(1) श्री-गुरु-चरण-पद्म, केवल-भक्ति-सद्म,\nबन्दो मुई सावधान मते\nजाहार प्रसादे भाई, ए भव तोरिय जायि,\nकृष्ण-प्राप्ति होय जाहां ह’ते\n\n(2) गुरु-मुख-पद्म-वाक्य, चित्तेते कोरिय ऐक्य,\nआर ना कोरिहो मने आशा\nश्री-गुरु-चरणे रति, ई से उत्तम-गति,\nजे प्रसादे पूरे सर्व आशा\n\n(3) चखु-दान दिलो जेई, जन्मे जन्मे प्रभु सेई,\nदिव्य ज्ञान हृदे प्रकाशितो\nप्रेम-भक्ति जाहां होइते, अविद्या विनाश जाते,\nवेदे गाय जाहार चरितो\n\n(4) श्री-गुरु करुणा-सिन्धु, अधम जनार बंधु,\nलोकनाथ लोकेर जीवन\nहा हा प्रभु करो दया, देहो मोरे पद-छाया,\एबे यश घुषुक त्रिभुवन"
  },
    "bhajan3": {
    "title": "Jaya Jaya Gorācānder Āratiko Śobhā",
    "english": "(1) (kiba) jaya jaya gorācānder āratiko śobhā\njāhnavī-taṭa-vane jaga-mana-lobhā\njaga-jana-mana-lobhā\n(gaurāṅger ārotik śobhā jaga-jana-mana-lobhā)\n\n(2) dakhiṇe nitāicānd, bāme gadādhara\nnikaṭe adwaita, śrīnivāsa chatra-dhara\n\n(3) bosiyāche gorācānd ratna-siṁhāsane\nārati koren brahmā-ādi deva-gaṇe\n\n(4) narahari-ādi kori’ cāmara dhulāya\nsañjaya-mukunda-bāsu-ghoṣ-ādi gāya\n\n(5) śaṅkha bāje ghaṇṭā bāje bāje karatāla\nmadhura mṛdaṅga bāje parama rasāla\n(śankha bāje ghaṇṭā bāje\nmadhur madhur madhur bāje)\n\n(6) bahu-koṭi candra jini’ vadana ujjvala\ngala-deśe bana-mālā kore jhalamala\n\n(7) śiva-śuka-nārada preme gada-gada\nbhakativinoda dekhe gorāra sampada",
    "hindi": "(1) (किबा) जय जय गौराचांदेर आरतीको शोभा\nजाह्नवी-तट-वने जग-मन-लोभा\nजग-जन-मन-लोभा\n(गौरांगेर आरतीक शोभा जग-जन-मन-लोभा)\n\n(2) दक्षिणे निताइचांद, बामे गदाधर\nनिकटे अद्वैत, श्रीनिवास छत्र-धर\n\n(3) बोसियाछे गौराचांद रत्न-सिंहासने\nआरती कोरें ब्रह्मा-आदि देव-गणे\n\n(4) नरहरि-आदि कोरि’ चामर ढुलाय\nसंजय-मुकुंद-बासु-घोष-आदि गाये\n\n(5) शंख बाजे घंटा बाजे बाजे करताल\nमधुर मृदंग बाजे परम रसाल\n(शंख बाजे घंटा बाजे\nमधुर मधुर मधुर बाजे)\n\n(6) बहु-कोटि चंद्र जिनी’ वदन उज्जवल\nगल-देशे बन-माला कोरे झलमल\n\n(7) शिव-शुक-नारद प्रेमे गद-गद\nभक्तिविनोद देखे गौरार संपद"
  },
    bhajan4: {
        title: "Hare Krishna Mantra",
        english: "Hare Krishna Hare Krishna\nKrishna Krishna Hare Hare\nHare Rama Hare Rama\nRama Rama Hare Hare\n\Our prayer of the Hare Krishna Mantra means addressing Radha and Krishna for being engaged in Their service. Hare Krishna means “Oh Hare, Oh Radharani! Oh Krishna! Please engage me in Your service.",
        hindi: "हरे कृष्ण हरे कृष्ण\nकृष्ण कृष्ण हरे हरे\nहरे राम हरे राम\nराम राम हरे हरे\n\nहमारी हरे कृष्ण महामंत्र की प्रार्थना का अर्थ है राधा और कृष्ण को संबोधित करना कि कृपया मुझे अपनी सेवा में लगा लें। हरे कृष्ण का अर्थ है — हे हरे! हे राधारानी! हे कृष्ण! कृपया मुझे अपनी प्रेममयी सेवा में लगाइए।"
    }
};

// DOM elements
const currentTimeDisplay = document.getElementById('current-time');
const bhajanTitle = document.getElementById('bhajan-title');
const bhajanText = document.getElementById('bhajan-text');
const englishButton = document.getElementById('english-button');
const hindiButton = document.getElementById('hindi-button');

// Developer control elements
const devToggle = document.getElementById('dev-toggle');
const devControls = document.getElementById('dev-controls');
const devHoursInput = document.getElementById('dev-hours');
const devMinutesInput = document.getElementById('dev-minutes');
const setTimeButton = document.getElementById('set-time-button');
const resetTimeButton = document.getElementById('reset-time-button');
const presetMorning = document.getElementById('preset-morning');
const presetMidMorning = document.getElementById('preset-midmorning');
const presetEvening = document.getElementById('preset-evening');
const presetDefault = document.getElementById('preset-default');

// Current bhajan and time override
let currentBhajan = null;
let useCustomTime = false;
let customHours = 12;
let customMinutes = 0;

// Get current time (real or custom)
function getCurrentTime() {
    if (useCustomTime) {
        // Return custom time
        const customDate = new Date();
        customDate.setHours(customHours);
        customDate.setMinutes(customMinutes);
        return customDate;
    } else {
        // Return real time
        return new Date();
    }
}

// Update time display
function updateTime() {
    const now = getCurrentTime();
    
    // Format for display
    let timeString = now.toLocaleTimeString();
    if (useCustomTime) {
        timeString += ' (Custom Time)';
    }
    
    currentTimeDisplay.textContent = `Current Time: ${timeString}`;
}

// Determine which bhajan to display based on time
function selectBhajanByTime() {
    const now = getCurrentTime();
    const hours = now.getHours();
    const minutes = now.getMinutes();
    
    // 4:30 AM - 5:30 AM
    if ((hours === 4 && minutes >= 30) || (hours === 5 && minutes <= 30)) {
        return bhajans.bhajan1;
    }
    // 7:15 AM - 8:30 AM
    else if ((hours === 7 && minutes >= 15) || (hours === 8 && minutes <= 30)) {
        return bhajans.bhajan2;
    }
    // 7:00 PM - 8:00 PM
    else if ((hours === 19 && minutes >= 0) || (hours === 20 && minutes <= 0)) {
        return bhajans.bhajan3;
    }
    // Default
    else {
        return bhajans.bhajan4;
    }
}

// Display bhajan
function displayBhajan(bhajan, language = 'english') {
    currentBhajan = bhajan;
    bhajanTitle.textContent = bhajan.title;
    bhajanText.textContent = bhajan[language];
    
    // Update active button state
    if (language === 'english') {
        englishButton.classList.add('active');
        hindiButton.classList.remove('active');
    } else {
        hindiButton.classList.add('active');
        englishButton.classList.remove('active');
    }
}

// Update bhajan based on current time
function updateBhajan() {
    const bhajan = selectBhajanByTime();
    
    // Only update if the bhajan has changed
    if (!currentBhajan || bhajan.title !== currentBhajan.title) {
        // Get the current language preference
        const currentLanguage = hindiButton.classList.contains('active') ? 'hindi' : 'english';
        displayBhajan(bhajan, currentLanguage);
    }
}

// Set custom time
function setCustomTime(hours, minutes) {
    customHours = hours;
    customMinutes = minutes;
    useCustomTime = true;
    
    // Update display
    updateTime();
    updateBhajan();
}

// Reset to real time
function resetToRealTime() {
    useCustomTime = false;
    
    // Update inputs to match current time
    const now = new Date();
    devHoursInput.value = now.getHours();
    devMinutesInput.value = now.getMinutes();
    
    // Update display
    updateTime();
    updateBhajan();
}

// Initialize app
function initApp() {
    updateTime();
    updateBhajan();
    
    // Update time every second
    setInterval(updateTime, 1000);
    
    // Check if bhajan should change every minute (only for real time)
    setInterval(() => {
        if (!useCustomTime) {
            updateBhajan();
        }
    }, 60000);
    
    // Initialize developer controls
    initDevControls();
}

// Initialize developer controls
function initDevControls() {
    // Set initial values
    const now = new Date();
    devHoursInput.value = now.getHours();
    devMinutesInput.value = now.getMinutes();
    
    // Toggle developer panel visibility
    devToggle.addEventListener('click', () => {
        devControls.classList.toggle('visible');
    });
    
    // Set custom time button
    setTimeButton.addEventListener('click', () => {
        const hours = parseInt(devHoursInput.value, 10) || 0;
        const minutes = parseInt(devMinutesInput.value, 10) || 0;
        setCustomTime(hours, minutes);
    });
    
    // Reset to real time button
    resetTimeButton.addEventListener('click', resetToRealTime);
    
    // Preset buttons
    presetMorning.addEventListener('click', () => {
        devHoursInput.value = 5;
        devMinutesInput.value = 0;
        setCustomTime(5, 0);
    });
    
    presetMidMorning.addEventListener('click', () => {
        devHoursInput.value = 8;
        devMinutesInput.value = 0;
        setCustomTime(8, 0);
    });
    
    presetEvening.addEventListener('click', () => {
        devHoursInput.value = 19;
        devMinutesInput.value = 30;
        setCustomTime(19, 30);
    });
    
    presetDefault.addEventListener('click', () => {
        devHoursInput.value = 12;
        devMinutesInput.value = 0;
        setCustomTime(12, 0);
    });
    
    // Also add keyboard shortcut for dev panel (Ctrl+Shift+D)
    document.addEventListener('keydown', (e) => {
        if (e.ctrlKey && e.shiftKey && e.key === 'D') {
            devControls.classList.toggle('visible');
            e.preventDefault();
        }
    });
}

// Language button event listeners
englishButton.addEventListener('click', () => {
    displayBhajan(currentBhajan, 'english');
});

hindiButton.addEventListener('click', () => {
    displayBhajan(currentBhajan, 'hindi');
});

// Initialize the app when page loads
window.addEventListener('load', initApp);